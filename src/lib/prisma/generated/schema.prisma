generator client {
  provider = "prisma-client-js"
  output   = "./generated"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id         String    @id @default(uuid())
  supabaseId String?   @unique @map("supabase_id")
  firstName  String    @map("first_name")
  lastName   String    @map("last_name")
  email      String    @unique
  phone      String?
  accounts   Account[]

  @@map("users")
}

enum ProcessArea {
  CIVIL
  LABOR
  CRIMINAL
  FAMILY
  TAX
  ADMINISTRATIVE
  CONSTITUTIONAL
  INTERNATIONAL
}

enum ProcessStatus {
  ONGOING
  SUSPENDED
  ARCHIVED
  CLOSED
}

model Process {
  id        String        @id @default(uuid())
  publicId  String        @unique @map("public_id")
  title     String
  area      ProcessArea
  status    ProcessStatus
  account   Account       @relation(fields: [accountId], references: [id])
  accountId String        @map("account_id")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("processes")
}

enum AccountType {
  ADMIN
  LAWYER
}

model Account {
  id        String      @id @default(uuid())
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  type      AccountType @map("account_type")
  user      User        @relation(fields: [userId], references: [id])
  userId    String      @map("user_id")
  processes Process[]
  clients   Client[]

  @@map("accounts")
}

model Client {
  id        String  @id @default(uuid())
  name      String
  email     String  @unique
  account   Account @relation(fields: [accountId], references: [id])
  accountId String  @map("account_id")

  @@map("clients")
}
